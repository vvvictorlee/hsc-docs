# 共识
`HSC`采用`PoSA`共识机制，具有交易成本低、交易延时低、交易并发高等特点，支持最多21个验证人节点；

PoSA是PoA和Pos的结合体。想要成为验证人，需要先提交提案，等待其他活跃的验证人进行投票，半数以上通过之后，则有资格成为验证人。任意地址均可对有资格成为验证人的地址进行质押，当验证人的质押量排名进入前21位之后，则会在下一个epoch成为活跃验证人。

所有的活跃验证人按照预定规则排序，轮流进行出块。如果有验证人在自己的出块轮次没能及时出块，则在过去n/2(n为活跃验证人的数量)个块内，没有参与过出块操作的活跃验证人，随机进行出块。最少n/2+1个活跃验证人正常工作，即可保证区块链的正常运行。

正常产块时，区块的难度值为2，未按照预定顺序进行产块时，区块的难度值为1。当区块链发生分叉时，区块链按照累计最大难度选择对应分叉。

## 名词说明
- 验证人，负责对链上交易进行打包出块；
- 活跃验证人，即当前负责打包出块的一组验证人，上限为21个。
- epoch。以区块为单位的时间间隔，目前`HSC`上 1epoch = 200block，每个epoch结束的时候，区块链会与系统合约交互，进行活跃验证人更新；

## 系统合约
[Hoo-eco-contracts](https://github.com/HooGroup/Hoo-eco-contracts)

目前验证人的管理，均由系统合约完成，目前的系统合约有：
- Proposal  负责管理验证人的准入资格，管理验证人提案和投票；
- Validators 负责对验证人进行排名管理、质押和解质押操作、分发区块奖励等；
- Punish 负责对不正常工作的活跃验证人进行惩罚操作；

区块链调用系统合约：
- 每个块结束的时候，会调用`Validators`合约，将区块中所有交易的手续费分发给active validator;
- 发现validator没有正常工作的时候，会调用`Punish`合约，对validator进行惩罚；
- 每个epoch结束的时候，会调用`Validators`合约，根据排名，更新active validator；

## 质押
任何账户，都可以对validator进行任意数量的质押操作，每个validator的最小质押量是`32HOO`。
如果想取回已质押的HOO，需要按照如下操作进行：
1. 发送调用`Validators`合约，发送针对某一个validator的解质押(unstake)的声明交易;
2. 等待`86400`个块之后，调用`Validators`合约，发送提取质押(withdrawStaking)的交易，将所有在此validator的质押取回；

## 惩罚措施
每当发现验证人没有按照预先设定进行出块的时候，就会在这个块结束时，自动调用`Punish`合约，对验证人进行计数。当计数达到24时，罚没验证人的所有收入。当计数达到48时，将验证人移除出活跃验证人列表，同时取消验证人资格。